#'
#+ load_catchDB
TEJ91 <- catchDB(x=TEJ81)
TEJ92 <- catchDB(x=TEJ82)
# 輸出資料前10筆及基本統計敘述
head(TEJ91,10)
summary(TEJ91)
# 輸出資料前10筆及基本統計敘述
head(TEJ92,10)
summary(TEJ92)
#' #####
#+ function_fnGDP
fnGDP <- function(x=TEJ91,file="DB2.xlsx",col_sht="GDP_colnames",DB_sht="GDP"){
GDP_colname <- read_excel(file, sheet=col_sht)
rGDP <- read_excel(file, sheet=DB_sht)
setnames(rGDP, old=as.character(GDP_colname$old), new=as.character(GDP_colname$new))
rGDP$year <- year(rGDP$Date)
rGDP$GDP <- log(rGDP$Value,base=exp(1))
GDP <- subset(rGDP,select=c(year,GDP))
return(merge(x,GDP,by="year"))}
#'
#+ load_fnGDP
TEJ101 <- fnGDP(x=TEJ91,file="DB2.xlsx",col_sht="GDP_colnames",DB_sht="GDP")
TEJ102 <- fnGDP(x=TEJ92,file="DB2.xlsx",col_sht="GDP_colnames",DB_sht="GDP")
readMNC <- function(x="MNC.xlsx",DB='MNC',attr='MNC_attr'){
MNCattr <- read_excel(x, sheet=attr, col_names = TRUE,col_types =as.vector(rep("text",3)))
MNC <- read_excel(x, sheet=DB, col_names = TRUE)
setnames(MNC,old=as.character(MNCattr$old), new=as.character(MNCattr$new))
MNC$year <- year(MNC$date)
return(MNC)
}
MNC <- readMNC()
fnMNC <- function(x=TEJ101,y=MNC,feedback=c('x','plot','table')){
x <- as.data.table(x)
y <- as.data.table(y)
y_TW <- plyr::count(y[y$nation %in% '台灣'],vars=c("company","year"))
setnames(y_TW,'freq','MNC_TW')
y_FOR <- plyr::count(y[!(y$nation %in% '台灣')],vars=c("company","year"))
setnames(y_FOR,'freq','MNC_FOREIGN')
y_mix <- merge(y_TW,y_FOR,by=c('company','year'),all = TRUE)
x <- merge(x,y_mix,by=c('company','year'))
# plot <-
ifelse(feedback=="x",return(x),ifelse(feedback=="plot",return(plot)))
}
TEJ111 <- fnMNC(x=TEJ101,y=MNC,feedback='x')
TEJ112 <- fnMNC(x=TEJ102,y=MNC,feedback='x')
View(TEJ111)
ETR_lmodel <- lm(ETR ~ STR+HHI+ROA+SIZE+LEV+INTANG+QUICK+EQINC+OUTINSTI+RELAT+FAM_Dum+GDP,TEJ101)
?recode
table(TEJ101$RELAT[is.finite(TEJ101$RELAT)])
table(TEJ101$RELAT[!is.finite(TEJ101$RELAT)])
TEJ_lm <- TEJ101$RELAT[!is.finite(TEJ101$RELAT)] <- 0
TEJ_lm <- replace(TEJ101,TEJ101$RELAT[!is.finite(TEJ101$RELAT)],0)
View(TEJ_lm)
ETR_lmodel <- lm(ETR ~ STR+HHI+ROA+SIZE+LEV+INTANG+QUICK+EQINC+OUTINSTI+RELAT+FAM_Dum+GDP,TEJ_lm)
ETR_lmodel
CETR_lmodel <- lm(CETR ~ STR+HHI+ROA+SIZE+LEV+INTANG+QUICK+EQINC+OUTINSTI+RELAT+FAM_Dum+GDP,TEJ_lm)
stargazer::stargazer(ETR_lmodel,type='html',style='default',summary=TRUE)
stargazer::stargazer(ETR_lmodel,type='text',style='default',summary=TRUE)
stargazer::stargazer(ETR_lmodel,CETR_lmodel,type='text',style='default',summary=TRUE)
write(
stargazer::stargazer(ETR_lmodel,CETR_lmodel,type='text',style='default',summary=TRUE),
file='tbB1.html',
append = TRUE
)
write(
stargazer::stargazer(ETR_lmodel,CETR_lmodel,type='html',style='default',summary=TRUE),
file='tbB1.html',
append = TRUE)
write(
stargazer::stargazer(ETR_lmodel,CETR_lmodel,type='html',style='default',summary=TRUE),
file='tbB1.html',
append = FALSE)
write(
stargazer::stargazer("TAXAVO",ETR_lmodel,CETR_lmodel,type='html',style='default',summary=TRUE),
file='tbB1.html',
append = FALSE)
write(
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
summary=TRUE),
file='tbB1.html',
append = FALSE)
?kable
write(
kable(ETR_lmodel,CETR_lmodel,align=TRUE),
file='tbB1_1.html',
append = FALSE
)
write(
kable(ETR_lmodel,CETR_lmodel,align='r'),
file='tbB1_1.html',
append = FALSE
)
?xtable
library(xtable)
?xtable
write(
xtable(ETR_lmodel,CETR_lmodel,align='r'),
file='tbB1_1.html',
append = FALSE
)
write(
xtable(ETR_lmodel,align='r'),
xtable(CETR_lmodel,align='r')
file='tbB1_1.html',
append = FALSE
)
write(
xtable(ETR_lmodel,align='r'),
xtable(CETR_lmodel,align='r'),
file='tbB1_1.html',
append = FALSE
)
write(
xtable(ETR_lmodel,align='r'),
#  xtable(CETR_lmodel,align='r'),
file='tbB1_1.html',
append = FALSE
)
write(
xtable(ETR_lmodel,align=rep('r',ncol(ETR_lmodel)+1)),
#  xtable(CETR_lmodel,align='r'),
file='tbB1_1.html',
append = FALSE
)
write(
xtable(ETR_lmodel,align=rep('r',5)),
#  xtable(CETR_lmodel,align='r'),
file='tbB1_1.html',
append = FALSE
)
write(
xtable(ETR_lmodel),
#  xtable(CETR_lmodel,align='r'),
file='tbB1_1.html',
append = FALSE
)
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
summary=TRUE,
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
summary=TRUE,
ci=TRUE,
ci.level=1,
single.row=TRUE,
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
summary=TRUE,
ci=TRUE,
ci.level=1.5,
single.row=TRUE,
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
summary=TRUE,
ci=TRUE,
ci.level=0.8,
single.row=TRUE,
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=TRUE,
out='tbB1.html')
ETR_lmodel2 <- lm(ETR ~ STR+HHI+STR_HHI+ROA+SIZE+LEV+INTANG+QUICK+EQINC+OUTINSTI+RELAT+FAM_Dum+GDP,TEJ_lm)
CETR_lmodel2 <- lm(CETR ~ STR+HHI+STR_HHI+ROA+SIZE+LEV+INTANG+QUICK+EQINC+OUTINSTI+RELAT+FAM_Dum+GDP,TEJ_lm)
ETR_lm_MNC2 <- lm(ETR ~ STR+HHI+STR_HHI+ROA+SIZE+LEV+INTANG+QUICK+EQINC+OUTINSTI+RELAT+FAM_Dum+GDP+MNC,TEJ_lm)
CETR_lm_MNC2 <- lm(CETR ~ STR+HHI+STR_HHI+ROA+SIZE+LEV+INTANG+QUICK+EQINC+OUTINSTI+RELAT+FAM_Dum+GDP+MNC,TEJ_lm)
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果─不包含STRATEGY×HHI",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=TRUE,
out='tbB1.html')
stargazer::stargazer(ETR_lmodel2,CETR_lmodel2,
type='html',
style='default',
title="實證結果─包含STRATEGY×HHI",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=TRUE,
out='tbB2.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果─不包含STRATEGY×HHI",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=TRUE,
add.lines="變數定義同表4-1",
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果─不包含STRATEGY×HHI",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=TRUE,
add.notes="變數定義同表4-1",
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果─不包含STRATEGY×HHI",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=TRUE,
notes="變數定義同表4-1",
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果─不包含STRATEGY×HHI",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=TRUE,
notes="變數定義同表4-1",
notes.align='l',
notes.lable="註：",
notes.append=TRUE,
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果─不包含STRATEGY×HHI",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=TRUE,
#notes="變數定義同表4-1",
notes.align='l',
notes.lable="註：",
notes.append=TRUE,
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果─不包含STRATEGY×HHI",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
#summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=TRUE,
#notes="變數定義同表4-1",
notes.align='l',
notes.lable="註：",
notes.append=TRUE,
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果─不包含STRATEGY×HHI",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
#summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=TRUE,
#notes="變數定義同表4-1",
notes.align='l',
notes.lable="註：",
#notes.append=TRUE,
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
title="實證結果─不包含STRATEGY×HHI",
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
#summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=TRUE,
notes = "變數定義同表4-1",
notes.align='l',
notes.lable="註：",
notes.append=TRUE,
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
#summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=F,
notes.append=TRUE,
title="實證結果─不包含STRATEGY×HHI",
notes.align='l',
notes.lable="註：",
notes = "變數定義同表4-1",
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
#summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=F,
notes.append=TRUE,
title="實證結果─不包含STRATEGY×HHI",
notes.align='l',
notes.lable="註：",
notes = "變數定義同表4-1",
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
#summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=T,
notes.append=F,
title="實證結果─不包含STRATEGY×HHI",
notes.align='l',
notes.lable="註：",
notes = "變數定義同表4-1",
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
#summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=T,
notes.append=T,
title="實證結果─不包含STRATEGY×HHI",
notes.align='l',
#  notes.lable="註：",
notes = "變數定義同表4-1",
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
"TAXAVO=B1+B2+B3",
type='html',
style='default',
align=TRUE,
column.labels = c("TAXAVO=ETR","TAXAVO=CashETR"),
digits=3,
#summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=T,
notes.append=T,
title="實證結果─不包含STRATEGY×HHI",
notes.align='l',
#  notes.lable="註：",
notes = "變數定義同表4-1",
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
"TAXAVO=B1+B2+B3",
type='html',
style='default',
align=TRUE,
column.labels = c("TAXAVO_it=ETR","TAXAVO=CashETR"),
digits=3,
#summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=T,
notes.append=T,
title="實證結果─不包含STRATEGY×HHI",
notes.align='l',
#  notes.lable="註：",
notes = "變數定義同表4-1",
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
"TAXAVO=B1+B2+B3",
type='html',
style='default',
align=TRUE,
column.labels = c("TAXAVO_{it}=ETR","TAXAVO=CashETR"),
digits=3,
#summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=T,
notes.append=T,
title="實證結果─不包含STRATEGY×HHI",
notes.align='l',
#  notes.lable="註：",
notes = "變數定義同表4-1",
out='tbB1.html')
stargazer::stargazer(ETR_lmodel,CETR_lmodel,
type='html',
style='default',
align=TRUE,
column.labels = c("TAXAVO_{it}=ETR_{it}","TAXAVO_{it}=CashETR_{it}"),
digits=3,
dep.var.labels.include=T,
dep.var.caption="formula",
#summary=TRUE,
ci=TRUE,
ci.level=0.99,
single.row=T,
notes.append=T,
title="實證結果─不包含STRATEGY×HHI",
notes.align='l',
#  notes.lable="註：",
notes = "變數定義同表4-1",
out='tbB1.html')
table(MNC$nation)
MNC_nation <- table(MNC$nation)
View(MNC_nation)
write(MNC_nation,"MNC_nation.csv",append = FALSE)
MNC_nation <- as.data.frame(table(MNC$nation))
write(MNC_nation,"MNC_nation.csv",append = FALSE)
MNC_nation <- as.data.frame(table(MNC$nation))
View(MNC_nation)
write(MNC_nation,"MNC_nation.csv",append = FALSE)
write(x=MNC_nation,file="MNC_nation.csv",append = FALSE)
?csv
??csv
write.csv(MNC_nation,file="MNC_nation.csv",append = FALSE)
write.csv(MNC_nation,file="MNC_nation.csv")
plottbA3 <- function(){
#fnmin <- function(x){apply(TEJ101[,6:21,with=FALSE],2,mean(x,na.rm=TRUE))}
#write(stargazer::stargazer(TEJ101,type = "html"),file="table3.html",append = TRUE)
write(stargazer::stargazer(TEJ101,type = "html"),file="table3.html",append = FALSE)
}
#' 運行plottbA3
#+ load_plottbA3
tbA3 <- plottbA3()
plottbA3 <- function(){
#fnmin <- function(x){apply(TEJ101[,6:21,with=FALSE],2,mean(x,na.rm=TRUE))}
#write(stargazer::stargazer(TEJ101,type = "html"),file="table3.html",append = TRUE)
write(stargazer::stargazer(TEJ101,type = "html"),file="table3.html",append = FALSE)
write(stargazer::stargazer(TEJ101,type = "pdf"),file="table3.pdf",append = FALSE)
}
#' 運行plottbA3
#+ load_plottbA3
tbA3 <- plottbA3()
?stargazer
q()
